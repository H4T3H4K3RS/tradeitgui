import{k as i,bC as U,v as N,w as k,aw as R,o as d,c as v,p as a,x as s,C as x,z as r,q as l,ax as q,ar as D,af as C,F as z,a as S,D as V,aq as E,ay as $,am as F,j as H,b as g,m as e,H as W,G as _,a9 as G,az as L,aa as M}from"./index.209d9e67.js";import{V as O,a as J,b as K,c as Q}from"./VTabs.ce195fe7.js";import{V as X,a as Y}from"./VTable.8c0e6fb5.js";const Z=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," # "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0424\u043E\u0442\u043E "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u0421\u0442\u0430\u0442\u0443\u0441 "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u0414\u0430\u0442\u0430 \u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u0414\u0430\u0442\u0430 \u0421\u043E\u0437\u0434\u0430\u043D\u0438\u044F "),e("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F ")])],-1),ee={class:"text-high-emphasis"},te={class:"text-high-emphasis"},ae={class:"text-high-emphasis"},se={class:"text-high-emphasis"},le={class:"text-high-emphasis"},oe={class:"text-high-emphasis"},ne={class:"text-high-emphasis"},ue={class:"text-high-emphasis"},ce={colspan:"8",class:"text-center text-body-1 justify-center align-center"},re={class:"text-sm text-disabled"},fe={__name:"index",setup(de){const h=i("exposed"),I=i([{name:"\u0412\u044B\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u043D\u044B\u0435",value:"exposed"},{name:"\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0438",value:"draft"},{name:"\u0423\u0436\u0435 \u043E\u0431\u043C\u0435\u043D\u044F\u043B\u0438 \u{1F389}",value:"exchanged"}]);H();const P=U(),j=N(),c=i(null),w=i(10),p=i(1),b=i(1),y=i(0),f=i({message:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0434\u0430\u043D\u043D\u044B\u0435...",status:0}),m=i({enabled:!1,type:"success",message:"Hello!"});k(()=>{c.value===null?f.value={message:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0434\u0430\u043D\u043D\u044B\u0435...",status:0}:c.value.length===0&&(f.value={message:"\u041D\u0435\u0442 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u043E\u0432",status:2})}),k(()=>{c.value=null,P.fetchItems({state:h.value,user:j.userData.id}).then(n=>{c.value=n.data.results,y.value=n.data.count,b.value=parseInt(y.value/w.value)+1}).catch(n=>{m.value={enabled:!0,message:n,type:"error"}})}),k(()=>{p.value>b.value&&(p.value=b.value)});const B=R(()=>{const n=c.value&&c.value.length?(p.value-1)*w.value+1:0,t=c.value?c.value.length+(p.value-1)*w.value:0;return`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u044B \u0441 ${n} \u043F\u043E ${t} \u0438\u0437 ${y.value} \u0441\u0442\u0440\u043E\u043A`}),T=n=>{let t="";return typeof n=="string"?t=n:t=new Date(n*1e3).toISOString(),t.slice(0,-11).replaceAll("T"," ").replaceAll("-",".")},A=async n=>{P.deleteItem({id:n}).then(t=>{if(console.log(t.data),c.value=c.value.filter(u=>u.id!==n),t.status>250)throw t.data;m.value={enabled:!0,message:`\u041F\u0440\u0435\u0434\u043C\u0435\u0442 ${n} \u0443\u0434\u0430\u043B\u0451\u043D`,type:"success"}}).catch(t=>{m.value={enabled:!0,message:`\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0430: ${t}`,type:"error"}})};return(n,t)=>(d(),v("div",null,[a(q,{modelValue:l(m).enabled,"onUpdate:modelValue":t[0]||(t[0]=u=>l(m).enabled=u),location:"bottom end",variant:"flat",color:l(m).type},{default:s(()=>[x(r(l(m).message),1)]),_:1},8,["modelValue","color"]),a(E,null,{default:s(()=>[a(D,{cols:"12",sm:"8",class:"w-100 d-flex d-md-block justify-center justify-md-start"},{default:s(()=>[a(O,{modelValue:l(h),"onUpdate:modelValue":t[1]||(t[1]=u=>C(h)?h.value=u:null),class:"mb-1"},{default:s(()=>[(d(!0),v(z,null,S(l(I),u=>(d(),g(K,{key:u.value,value:u.value},{default:s(()=>[x(r(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(D,{cols:"12",sm:"4"},{default:s(()=>[a(V,{class:"w-100",to:{name:"items-new"},"append-icon":"tabler-circle-plus"},{default:s(()=>[x(" \u0420\u0430\u0437\u043C\u0435\u0441\u0442\u0438\u0442\u044C ")]),_:1})]),_:1})]),_:1}),a(F,{flat:""},{default:s(()=>[a($,null,{default:s(()=>[a(J,{modelValue:l(h),"onUpdate:modelValue":t[3]||(t[3]=u=>C(h)?h.value=u:null),touch:{left:null,right:null}},{default:s(()=>[(d(!0),v(z,null,S(l(I),u=>(d(),g(Q,{key:u.value,value:u.value},{default:s(()=>[a(X,{class:"text-no-wrap pb-5"},{default:s(()=>[Z,e("tbody",null,[(d(!0),v(z,null,S(l(c),o=>(d(),v("tr",{key:o.id,style:{height:"3.5rem"}},[e("td",ee,r(o.id),1),e("td",te,r(o.name),1),e("td",ae,r(o.description.slice(0,100))+" "+r(o.description.length>100?"...":""),1),e("td",se,r(o.photos.length),1),e("td",le,[a(W,{variant:"tonal",color:o.moderation_state==="Accepted"?"success":o.moderation_state==="Pending"?"warning":"error"},{default:s(()=>[x(r(o.moderation_state),1)]),_:2},1032,["color"])]),e("td",oe,r(T(o.time_modified)),1),e("td",ne,r(T(o.time_created)),1),e("td",ue,[a(V,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"items-view-id",params:{id:o.id}}},{default:s(()=>[a(_,{size:"22",icon:"tabler-eye"})]),_:2},1032,["to"]),a(V,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"items-edit-id",params:{id:o.id}}},{default:s(()=>[a(_,{size:"22",icon:"tabler-edit"})]),_:2},1032,["to"]),a(V,{icon:"",size:"x-small",color:"default",variant:"text",onClick:ie=>A(o.id)},{default:s(()=>[a(_,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),128))]),G(e("tfoot",null,[e("tr",null,[e("td",ce,[x(r(l(f).message)+" ",1),l(f).status===0?(d(),g(L,{key:0,width:3,color:"primary",indeterminate:""})):l(f).status===1?(d(),g(_,{key:1,color:"success",icon:"tabler-tick"})):(d(),g(_,{key:2,color:"error",icon:"tabler-x"}))])])],512),[[M,!l(c)||!l(c).length]])]),_:1}),a($,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3"},{default:s(()=>[e("span",re,r(l(B)),1),a(Y,{modelValue:l(p),"onUpdate:modelValue":t[2]||(t[2]=o=>C(p)?p.value=o:null),size:"small","total-visible":4,length:l(b)},null,8,["modelValue","length"])]),_:1})]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}};export{fe as default};
