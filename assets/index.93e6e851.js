import{k as n,b8 as z,v as A,aW as x,a8 as D,o as h,c as _,p as c,w as u,B as k,y as i,q as o,aY as S,b9 as E,ba as C,m as t,F as N,a as j,a0 as F,a1 as M,b,bb as R,E as g,b0 as O,j as U,C as I}from"./index.06ce4c3e.js";import{V as W,a as q}from"./VTable.0ed82c9d.js";const J=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," # "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Author "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Modified date "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Creation date "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Actions ")])],-1),L={class:"text-high-emphasis"},Y={class:"text-high-emphasis"},G={class:"text-high-emphasis"},H={class:"text-high-emphasis"},K={class:"text-high-emphasis"},Q={colspan:"8",class:"text-center text-body-1 justify-center align-center"},X={class:"text-sm text-disabled"},se={__name:"index",setup(Z){n("draft"),U();const w=z(),$=A(),d=n(!1),f=n(""),p=n("error"),s=n(null),y=n(10),r=n(1),m=n(1),B=n(0),v=n({message:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0434\u0430\u043D\u043D\u044B\u0435...",status:0});x(()=>{s.value===null?v.value={message:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0434\u0430\u043D\u043D\u044B\u0435...",status:0}:s.value.length===0&&(v.value={message:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445",status:2})}),x(()=>{s.value=null,w.fetchItems({user:$.$state.userData.id}).then(a=>{s.value=a.data}).catch(a=>{d.value=!0,p.value="error",f.value=a,console.log(a)})}),x(()=>{r.value>m.value&&(r.value=m.value)});const P=D(()=>{const a=s.value&&s.value.length?(r.value-1)*y.value+1:0,e=s.value?s.value.length+(r.value-1)*y.value:0;return`Showing ${a} to ${e} of ${B.value} entries`}),V=a=>{let e="";return typeof a=="string"?e=a:e=new Date(a*1e3).toISOString(),e.slice(0,-5).replaceAll("T"," ").replaceAll("-",".")},T=async a=>{w.deleteItem({id:a}).then(e=>{if(console.log(e.data),s.value=s.value.filter(l=>l.id!==a),e.status>250)throw`Failed to save! Response: ${JSON.stringify(e.data)}`;d.value=!0,p.value="success",f.value=`Item ${a} deleted`}).catch(e=>{d.value=!0,p.value="error",f.value=e,console.log(e)})};return(a,e)=>(h(),_("div",null,[c(E,{modelValue:o(d),"onUpdate:modelValue":e[0]||(e[0]=l=>S(d)?d.value=l:null),location:"top end",variant:"flat",color:o(p)},{default:u(()=>[k(i(o(f)),1)]),_:1},8,["modelValue","color"]),c(O,{flat:""},{default:u(()=>[c(C,null,{default:u(()=>[c(W,{class:"text-no-wrap pb-5"},{default:u(()=>[J,t("tbody",null,[(h(!0),_(N,null,j(o(s),l=>(h(),_("tr",{key:l.id,style:{height:"3.5rem"}},[t("td",L,i(l.id),1),t("td",Y,i(l.author),1),t("td",G,i(V(l.time_modified)),1),t("td",H,i(V(l.time_created)),1),t("td",K,[c(I,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"items-view-id",params:{id:l.item}}},{default:u(()=>[c(g,{size:"22",icon:"tabler-eye"})]),_:2},1032,["to"]),c(I,{icon:"",size:"x-small",color:"default",variant:"text",onClick:ee=>T(l.id)},{default:u(()=>[c(g,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),128))]),F(t("tfoot",null,[t("tr",null,[t("td",Q,[k(i(o(v).message)+" ",1),o(v).status===0?(h(),b(R,{key:0,width:3,color:"primary",indeterminate:""})):o(v).status===1?(h(),b(g,{key:1,color:"success",icon:"tabler-tick"})):(h(),b(g,{key:2,color:"error",icon:"tabler-x"}))])])],512),[[M,!o(s)||!o(s).length]])]),_:1}),c(C,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3"},{default:u(()=>[t("span",X,i(o(P)),1),c(q,{modelValue:o(r),"onUpdate:modelValue":e[1]||(e[1]=l=>S(r)?r.value=l:null),size:"small","total-visible":4,length:o(m)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]))}};export{se as default};
