import{k as i,bI as U,v as j,aY as S,aa as F,o as d,c as f,p as a,w as r,B as V,y as c,q as s,a_ as w,bb as M,F as C,a as z,z as R,C as y,ba as $,b2 as O,j as W,b as x,m as t,E as g,a2 as q,bs as J,a3 as L}from"./index.cd0f8983.js";import{V as Y,a as G,c as H,b as K}from"./VTabs.52be9fce.js";import{V as Q}from"./VTable.a1fd0acf.js";import{V as X}from"./VPagination.0a29c8b7.js";import"./index.affa8c13.js";const Z=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," # "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Name "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Description "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Photos Count "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Modified date "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Creation date "),t("th",{scope:"col",class:"text-subtitle-2 text-wrap"}," Actions ")])],-1),ee={class:"text-high-emphasis"},te={class:"text-high-emphasis"},ae={class:"text-high-emphasis"},se={class:"text-high-emphasis"},le={class:"text-high-emphasis"},oe={class:"text-high-emphasis"},ne={class:"text-high-emphasis"},ue={colspan:"8",class:"text-center text-body-1 justify-center align-center"},re={class:"text-sm text-disabled"},fe={__name:"index",setup(ie){const p=i("draft"),I=i([{name:"Draft",value:"draft"},{name:"Exchnaged",value:"exchanged"},{name:"Exposed",value:"exposed"}]);W();const T=U(),B=j(),v=i(!1),_=i(""),b=i("error"),n=i(null),D=i(10),h=i(1),k=i(1),E=i(0),m=i({message:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0434\u0430\u043D\u043D\u044B\u0435...",status:0});S(()=>{n.value===null?m.value={message:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0434\u0430\u043D\u043D\u044B\u0435...",status:0}:n.value.length===0&&(m.value={message:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445",status:2})}),S(()=>{n.value=null,T.fetchItems({state:p.value,user:B.$state.userData.id}).then(l=>{n.value=l.data}).catch(l=>{v.value=!0,b.value="error",_.value=l,console.log(l)})}),S(()=>{h.value>k.value&&(h.value=k.value)});const N=F(()=>{const l=n.value&&n.value.length?(h.value-1)*D.value+1:0,e=n.value?n.value.length+(h.value-1)*D.value:0;return`Showing ${l} to ${e} of ${E.value} entries`}),P=l=>{let e="";return typeof l=="string"?e=l:e=new Date(l*1e3).toISOString(),e.slice(0,-5).replaceAll("T"," ").replaceAll("-",".")},A=async l=>{T.deleteItem({id:l}).then(e=>{if(console.log(e.data),n.value=n.value.filter(o=>o.id!==l),e.status>250)throw`Failed to save! Response: ${JSON.stringify(e.data)}`;v.value=!0,b.value="success",_.value=`Item ${l} deleted`}).catch(e=>{v.value=!0,b.value="error",_.value=e,console.log(e)})};return(l,e)=>(d(),f("div",null,[a(M,{modelValue:s(v),"onUpdate:modelValue":e[0]||(e[0]=o=>w(v)?v.value=o:null),location:"top end",variant:"flat",color:s(b)},{default:r(()=>[V(c(s(_)),1)]),_:1},8,["modelValue","color"]),a(Y,{modelValue:s(p),"onUpdate:modelValue":e[1]||(e[1]=o=>w(p)?p.value=o:null),class:"mb-1"},{default:r(()=>[(d(!0),f(C,null,z(s(I),o=>(d(),x(H,{key:o.value,value:o.value},{default:r(()=>[V(c(o.name),1)]),_:2},1032,["value"]))),128)),a(R),a(y,{to:{name:"items-new"},"append-icon":"tabler-plus"},{default:r(()=>[V(" New ")]),_:1})]),_:1},8,["modelValue"]),a(O,{flat:""},{default:r(()=>[a($,null,{default:r(()=>[a(G,{modelValue:s(p),"onUpdate:modelValue":e[3]||(e[3]=o=>w(p)?p.value=o:null)},{default:r(()=>[(d(!0),f(C,null,z(s(I),o=>(d(),x(K,{key:o.value,value:o.value},{default:r(()=>[a(Q,{class:"text-no-wrap pb-5"},{default:r(()=>[Z,t("tbody",null,[(d(!0),f(C,null,z(s(n),u=>(d(),f("tr",{key:u.id,style:{height:"3.5rem"}},[t("td",ee,c(u.id),1),t("td",te,c(u.name),1),t("td",ae,c(u.description.slice(0,100))+" "+c(u.description.length>100?"...":""),1),t("td",se,c(u.photos.length),1),t("td",le,c(P(u.time_modified)),1),t("td",oe,c(P(u.time_created)),1),t("td",ne,[a(y,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"items-view-id",params:{id:u.id}}},{default:r(()=>[a(g,{size:"22",icon:"tabler-eye"})]),_:2},1032,["to"]),a(y,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"items-edit-id",params:{id:u.id}}},{default:r(()=>[a(g,{size:"22",icon:"tabler-edit"})]),_:2},1032,["to"]),a(y,{icon:"",size:"x-small",color:"default",variant:"text",onClick:ce=>A(u.id)},{default:r(()=>[a(g,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),128))]),q(t("tfoot",null,[t("tr",null,[t("td",ue,[V(c(s(m).message)+" ",1),s(m).status===0?(d(),x(J,{key:0,width:3,color:"primary",indeterminate:""})):s(m).status===1?(d(),x(g,{key:1,color:"success",icon:"tabler-tick"})):(d(),x(g,{key:2,color:"error",icon:"tabler-x"}))])])],512),[[L,!s(n)||!s(n).length]])]),_:1}),a($,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3"},{default:r(()=>[t("span",re,c(s(N)),1),a(X,{modelValue:s(h),"onUpdate:modelValue":e[2]||(e[2]=u=>w(h)?h.value=u:null),size:"small","total-visible":4,length:s(k)},null,8,["modelValue","length"])]),_:1})]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}};export{fe as default};
